<div ng-controller="PlateauxActionCaseController" ng-show="actionCase.phase >= 0">

    <!-- *** RECOMPENSES *** -->

    <div ng-if="actionCase.phase == 1 && actionCase.categorie === 'recompense' && actionCase.recompense.categorie === 'grande_carte' && actionCase.recompense.type === 'pioche'" layout="column" class="partie-cartouche-container">

        <!-- Titre -->
        <div layout="row" layout-align="center center" class="confrontations-titre red-font">
            <span>
                Tu gagnes {{actionCase.recompense.valeur}}
                <ng-pluralize count="actionCase.recompense.valeur" when="{'0':'grande carte','1':'grande carte','other':'grandes cartes'}"></ng-pluralize>
            </span>
        </div>

        <!-- Body -->
        <div layout="row" layout-align="space-around center" class="cartouche-body">
            <div ng-repeat="carte in actionCase.grandesCartes" layout-align="center center" style="outline: none;width: 140px;height: 220px;margin: 5px;">
                <img ng-src="{{'modules/cartes/img/hors-pioche/cartes_hors_pioche_'+carte.code+'.png'}}" ng-click="getGrandeCarte(carte.id,$index)" ng-if="!carte.completed && carte.quantity > 0" style="width: 140px;height: 220px;" class="jeu-grandes-cartes-completed">
                <img ng-src="{{'modules/cartes/img/hors-pioche/cartes_hors_pioche_'+carte.code+'.png'}}" ng-if="carte.completed || carte.quantity === 0" style="width: 140px;height: 220px;" class="jeu-grandes-cartes">
                <img src="modules/core/img/core_icones_checkmark_whitebackground.png" ng-if="carte.completed" style="position: absolute;width: 80px;height: 80px;margin-top: -142px;margin-left: -37px;opacity: 0.5;">
                <div ng-if="!carte.completed" style="position: absolute;font-size: 150px;margin-top: -209px;margin-left: 32px;opacity: 0.3;pointer-events: none;color:; white;">
                    {{carte.quantity}}
                </div>
            </div>
        </div>

    </div>

    <!-- *** QUESTIONS *** -->

    <div ng-if="actionCase.phase == 1 && actionCase.categorie === 'question'" layout="column" class="partie-cartouche-container">

        <!-- Titre -->
        <div layout="row" layout-align="center center" class="confrontations-titre red-font">
            <span>
                Sauras-tu répondre à cette question ?
            </span>
        </div>

        <!-- Body -->
        <div layout="row" layout-align="space-around center" class="cartouche-body">

            <img ng-src="{{'modules/joueurs/img/joueurs_picture_'+actionCase.question.joueur+'.png'}}" style="width: 100px;">

            <div layout="column" style="margin-left: 40px;margin-right: 40px;">
                <span style="font-size: 22px;"> 
                    {{actionCase.question.question}}
                </span>
                <md-input-container class="cartes-input" style="width: 200px;font-size: 16px;">
                    <md-select ng-model="actionCase.reponse" required aria-label="Reponse" style="text-align: initial;">
                        <md-option ng-repeat="option in actionCase.question.options track by $index" style="text-align: initial;">{{option}}</md-option>
                    </md-select>
                    <label style="text-align: initial;">Réponse</label>
                </md-input-container>
                <a ng-click="montrerIndice()" ng-if="!actionCase.indice" style="font-size: 16px;margin-top: 32px;color: #484848;text-align: left;"> 
                    Demander un indice (la récompense sera divisée par 2)
                </a>
                <span ng-if="actionCase.indice" style="font-size: 16px;margin-top: 32px;color: #484848;text-align: left;">
                    Indice: {{actionCase.question.indice}}
                </span>
            </div>

            <div layout="column">
                <md-button ng-click="repondreQuestion()" ng-disabled="actionCase.reponse == undefined" class="confrontations-button red-font md-primary md-raised" style="height: 20px;">
                    C'est mon dernier mot
                </md-button>
            </div>

        </div>

    </div>

    <div ng-if="actionCase.phase == 2 && actionCase.categorie === 'question'" layout="column" class="partie-cartouche-container">

        <!-- Titre -->
        <div layout="row" layout-align="center center" class="confrontations-titre red-font">
            <span ng-if="actionCase.succes === 'succes'">
                Bonne réponse !
            </span>
            <span ng-if="actionCase.succes !== 'succes'">
                Mauvaise réponse...
            </span>
        </div>

        <!-- Body -->
        <div layout="row" layout-align="space-around center" class="cartouche-body">

            <img ng-src="{{'modules/joueurs/img/joueurs_picture_'+actionCase.question.joueur+'.png'}}" style="width: 100px;">

            <div layout="column" style="margin-left: 40px;margin-right: 40px;">
                <span ng-if="actionCase.succes === 'echec'" style="font-size: 22px;"> 
                    {{actionCase.question.question}}
                </span>
                <div ng-if="actionCase.succes !== 'echec'" layout="column" style="font-size: 22px;">
                    <span>
                        Tu gagnes {{actionCase.recompenseCartes}}
                        <ng-pluralize count="actionCase.recompenseCartes" when="{'0':'carte','1':'carte','other':'cartes'}"></ng-pluralize>
                         et {{actionCase.recompenseGlutis}}₲.
                    </span>
                </div>
                <div ng-if="actionCase.succes === 'echec'" layout="column" layout-align="center start" style="font-size: 18px;">
                    <span style="color: red;"> 
                        Ta réponse : {{actionCase.reponse}}
                    </span>
                    <span style="color: green;"> 
                        Bonne réponse : {{actionCase.question.reponse}}
                    </span>
                </div>
            </div>

            <div layout="column">
                <md-button ng-click="cancelActionCase()" class="confrontations-button red-font md-primary md-raised" style="height: 20px;">
                    OK
                </md-button>
            </div>

        </div>

    </div>

    <!-- *** ACHATS *** -->

    <div ng-if="(actionCase.phase == 1 || actionCase.phase == 1.1) && actionCase.categorie === 'achat'" layout="column" class="partie-cartouche-container">

        <!-- Titre -->
        <div layout="row" layout-align="center center" class="confrontations-titre red-font">
            <span ng-show="actionCase.phase == 1">
                Bienvenue en case {{actionCase.numero}} ! Es-tu intéressé par nos articles ?
            </span>
            <span ng-show="actionCase.phase == 1.1">
                Avec ceci ?
            </span>
        </div>

        <!-- Body -->
        <div layout="row" layout-align="space-around center" class="cartouche-body">

            <div ng-repeat="carte in actionsCase.achat">
                <img ng-src="{{'modules/cartes/img/hors-pioche/cartes_hors_pioche_'+carte.code+'.png'}}" ng-click="achatObjet(carte)" style="width: 140px;height: 225px;margin: 5px 15px;box-sizing: content-box;border: ">
            </div>

            <md-button ng-click="cancelActionCase()" class="confrontations-button red-font md-primary md-raised" style="height: 20px;">
                Non !
            </md-button>

        </div>

    </div>

    <div ng-if="actionCase.phase == 2 && actionCase.categorie === 'achat'" layout="column" class="partie-cartouche-container">

        <!-- Titre -->
        <div layout="row" layout-align="center center" class="confrontations-titre red-font">
            <span>
                {{actionCase.carte.nom}}
            </span>
        </div>

        <!-- Body -->
        <div layout="row" layout-align="space-around center" class="cartouche-body">

            <div>
                <img ng-src="{{'modules/cartes/img/hors-pioche/cartes_hors_pioche_'+actionCase.carte.code+'.png'}}" style="width: 140px;height: 225px;margin: 5px 15px;box-sizing: content-box;">
            </div>

            <div ng-if="actionCase.carte.info.paiement === 'glutis' && actionCase.paiementPossible" style="width: 250px;">
                Souhaites-tu acheter cet objet pour {{actionCase.carte.info.prix}}₲ ?
            </div>
            <div ng-if="actionCase.carte.info.paiement === 'glutis' && !actionCase.paiementPossible" style="width: 250px;">
                Tu n'as pas assez de glutis pour acheter cet objet : il coûte {{actionCase.carte.info.prix}}₲
            </div>
            <div ng-if="actionCase.carte.info.paiement === 'echange' && actionCase.paiementPossible" style="width: 250px;">
                Souhaites-tu acheter cet objet contre une carte {{actionCase.carteEchangeNom}} ?
            </div>
            <div ng-if="actionCase.carte.info.paiement === 'echange' && !actionCase.paiementPossible" layout="column" style="width: 250px;font-size: 20px;">
                <span>
                    Nous échangerions volontiers notre carte {{actionCase.carte.nom}} contre cette carte :
                </span>
            </div>
            
            <img ng-src="{{'modules/cartes/img/hors-pioche/cartes_hors_pioche_'+actionCase.carte.info.echange+'.png'}}" ng-if="actionCase.carte.info.paiement === 'echange' && !actionCase.paiementPossible" style="width: 140px;height: 225px;margin: 5px 15px;box-sizing: content-box;">
            
            <div ng-if="actionCase.paiementPossible" layout="column">
                <md-button ng-click="acheterObjet()" class="confrontations-button red-font md-primary md-raised" style="height: 20px;">
                    Payer
                </md-button>
                <md-button ng-click="cancelActionCase()" class="confrontations-button red-font md-primary md-raised" style="height: 20px;">
                    Non merci
                </md-button>
            </div>

            <div ng-if="!actionCase.paiementPossible" layout="column">
                <md-button ng-click="acheterObjet()" class="confrontations-button red-font md-primary md-raised" style="height: 20px;">
                    Je reviendrai plus tard
                </md-button>
            </div>

        </div>

    </div>

    <div ng-if="actionCase.phase == 3 && actionCase.categorie === 'achat'" layout="column" class="partie-cartouche-container">

        <!-- Titre -->
        <div layout="row" layout-align="center center" class="confrontations-titre red-font">
            <span>
                {{actionCase.carte.nom}}
            </span>
        </div>

        <!-- Body -->
        <div layout="row" layout-align="space-around center" class="cartouche-body">

            <div>
<!--                 <img ng-src="{{'modules/cartes/img/hors-pioche/cartes_hors_pioche_'+actionCase.carte.code+'.png'}}" style="width: 140px;height: 225px;margin: 5px 15px;box-sizing: content-box;"> -->
            </div>

            <div style="width: 250px;">
                Merci pour ton achat !
            </div>

        </div>

    </div>




    <!-- *** ACTIONS *** -->

    <div ng-if="actionCase.phase > 0 && actionCase.categorie === 'action'" layout="column" class="partie-cartouche-container">

    	<!-- Titre -->
     	<div layout="row" layout-align="center center" class="confrontations-titre red-font">
            <span>
                 Case {{actionCase.numero}}
            </span>
        </div>

        <!-- Body -->
        <div layout="row" class="cartouche-body">

            <!-- Donner passeport -->
    <!--         <div ng-if="actionCase.numero === 'hub' && actionCase.phase === 1" layout="row" flex layout-align="center center" style="outline: none;width: 140px;height: 180px;padding: 5px;">
                <img ng-src="{{'modules/cartes/img/pioche/cartes_pioche_'+carte+'.png'}}" ng-class="carte.completed ? 'jeu-missions-carte-completed' : 'jeu-missions-carte'">
            </div>  -->

            <!-- Description -->
            <div ng-if="actionCaseDisplay.description" layout="column" layout-align="center center" class="confrontations-description">
                <div layout="column">
                    <span>
                        {{actionCase.description}}
                    </span>
                </div>
            </div>

            <!-- Image -->
            <div ng-if="actionCaseDisplay.image" layout="column" layout-align="center center" class="confrontations-description" style="width: 390px;">
                <div layout="column" layout-align="center center">
                    <span>
                        {{actionCase.description}}
                    </span>
                    <img ng-src="{{actionCase.image}}" style="width: 200px;">
                </div>
            </div>

            <!-- Perte de cartes -->
            <div ng-if="actionCaseDisplay.perteCartes" layout="column" layout-align="center center" class="confrontations-description" style="width: 390px;">
                <red-cartes-jeter bouton-name="'Défausser'" quantite="2" description="'Tu perds des cartes'"></red-cartes-jeter>
            </div>

            <!-- Valise non-materialisee -->
            <div layout="column" layout-align="space-around start" ng-if="actionCase.valiseNonMaterialisee !== undefined">
                <span style="width: 500px;">
                    {{actionCase.description}}
                </span>
                <div layout="row" ng-repeat="objet in actionCase.valiseNonMaterialisee" style="padding: 5px;text-align: start;">
                    <span ng-if="objet === valiseNonMaterialisee[$index]" style="color: green;width: 250px;font-size: 18px;">
                        {{$index + 1}}. {{objet}}
                    </span>
                    <div ng-if="objet !== valiseNonMaterialisee[$index]" layout="row">
                        <span style="color: red;width: 250px;font-size: 18px;">
                            {{$index + 1}}. {{objet}}
                        </span>
    <!--                     <span style="color: green;font-size: 16px;">
                            {{valiseNonMaterialisee[$index]}}
                        </span> -->
                    </div>
                </div>
                <md-input-container ng-if="valiseNonMaterialiseeIndex < valiseNonMaterialisee.length && (valiseNonMaterialiseeIndex === 0 || actionCase.valiseNonMaterialisee[valiseNonMaterialiseeIndex-1] === valiseNonMaterialisee[valiseNonMaterialiseeIndex-1])" style="width: 400px;font-size: 16px;text-align: start;">
                    <md-select ng-model="actionCase.valiseNonMaterialisee[valiseNonMaterialiseeIndex]" ng-change="ajouteValise(valiseNonMaterialiseeIndex)" required aria-label="Objet">
                        <md-option ng-repeat="objet in objets | orderBy:'nom'" ng-if="actionCase.valiseNonMaterialisee.indexOf(objet.nom) < 0">{{objet.nom}}</md-option>
                    </md-select>
                    <label>Objet</label>
                </md-input-container>
                <div ng-if="actionCase.vnmCorrect">
                    <span style="width: 500px;font-size: 18px;">
                        Tu peux ajouter un objet de ton choix dans la valise :
                    </span>
                    <md-input-container style="width: 400px;font-size: 16px;text-align: start;">
                        <md-select ng-model="actionCase.nouvelObjet" required ng-change="nouvelObjet()" aria-label="Objet">
                            <md-option ng-repeat="objet in objets | orderBy:'nom'" ng-if="actionCase.valiseNonMaterialisee.indexOf(objet.nom) < 0">{{objet.nom}}</md-option>
                        </md-select>
                        <label>Nouvel objet</label>
                    </md-input-container>
                </div>
                <div ng-if="actionCase.vnmCorrect === false" style="width: 100%;">
                    <span>
                        Erreur ! Il fallait prendre : {{valiseNonMaterialisee[valiseNonMaterialiseeIndex-1]}}
                    </span>
                </div>
            </div>

            <!-- Boutons -->
            <div layout="column" layout-align="center center" class="confrontations-buttons" ng-hide="buttonsHidden">
                <md-button ng-click="startActionCase('action',actionCase.numero)" ng-disabled="okButtonDisabled" class="confrontations-button red-font md-primary md-raised">
                    {{bouton1}}
                </md-button>
                <md-button ng-if="bouton2 != ''" ng-click="cancelActionCase()" class="confrontations-button red-font md-primary md-raised">
                    {{bouton2}}
                </md-button>
            </div>

        </div>

     </div>
 </div>